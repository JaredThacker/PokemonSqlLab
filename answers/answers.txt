-What are all the types of pokemon that a pokemon can have?
select name from types;

-What is the name of the pokemon with id 45?
select name from pokemons where id = 45;

-How many pokemon are there?
select count(name) from pokemons;

-How many types are there?
select count(name) from types;

-How many pokemon have a secondary type?
select count(secondary_type) from pokemons where secondary_type IS NOT NULL;

-What is each pokemon's primary type?
select pokemons.name, types.name from pokemons left join types on pokemons.primary_type = types.id;

-What is Rufflet's secondary type?
select pokemons.name, types.name, pokemons.secondary_type from pokemons left join types on pokemons.secondary_type = types.id where pokemons.name = 'Rufflet';

-What are the names of the pokemon that belong to the trainer with trainerID 303?
select pokemons.name from pokemons left join pokemon.pokemon_trainer on pokemons.id = pokemon_trainer.pokemon_id where trainerID = 303;

-How many pokemon have a secondary type Poison
select count(*) from pokemons where pokemons.secondary_type = 7;

-What are all the primary types and how many pokemon have that type?
select pokemons.name, t.name from pokemons join pokemon.types as t on pokemons.primary_type = t.id where primary_type = 1;
select count(*) from pokemons join pokemon.types as t on pokemons.primary_type = t.id where primary_type = 1;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 2;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 2;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 3;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 3;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 4;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 4;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 5;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 5;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 6;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 6;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 7;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 7;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 8;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 8;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 9;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 9;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 10;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 10;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 11;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 11;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 12;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 12;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 13;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 13;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 14;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 14;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 15;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 15;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 16;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 16;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 17;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 17;
select p.name, t.name from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 18;
select count(*) from pokemons as p join pokemon.types as t on p.primary_type = t.id where primary_type = 18;

-How many pokemon at level 100 does each trainer with at least one level 100 pokemone have? (Hint: your query should not display a trainer
select pokemon_trainer.trainerID, count(pokemons.name) from pokemon_trainer left join pokemons on pokemon_id = pokemons.id where pokelevel = 100 group by pokemon_trainer.trainerID;

-How many pokemon only belong to one trainer and no other?
select count(*) from (select p.name, count(p.name) from pokemons as p inner join pokemon_trainer pt on p.id = pt.pokemon_id group by pt.pokemon_id having count(pt.pokemon_id)=1) as subq;

-Write a query that returns the following columns:
Pokemon Name	Trainer Name	Level	Primary Type	Secondary Type
Pokemon's name	Trainer's name	Current Level	Primary Type Name	Secondary Type Name
Sort the data by finding out which trainer has the strongest pokemon so that this will act as a ranking of strongest to weakest trainer. You may interpret strongest in whatever way you want, but you will have to explain your decision.


select p.name as 'Pokemon Name', t.trainername as 'Trainer Name', pt.pokelevel as 'Level', types.name as 'Primary Type', secTypes.name as 'Secondary Type'
from pokemons as p
inner join types on p.primary_type = types.id
inner join types as secTypes on p.secondary_type = secTypes.id
inner join pokemon_trainer as pt on p.id = pt.pokemon_ID
inner join trainers as t on t.trainerID=pt.trainerID
inner join
    (select trainerID, avg(pokelevel), count(pokelevel) * round(avg(pokelevel) * (avg(maxhp) + avg(attack) + avg(defense) + avg(spatk) + avg(spdef) + avg(speed))) as score
    from pokemon_trainer
    group by trainerID
    order by score DESC) as score on score.trainerID = t.trainerID
group by pt.trainerID,pt.pokemon_id,pt.pokelevel
order by score.score DESC;